import{u as U,f as te,g as le,h as O,i as ie,j as se,t as ue,k as ae,l as A,m as R,n as re,p as P,q as l,s as ne,R as I,v as oe,x as ce,y as de,z as me,A as he,B as ge,C as ve,D as pe,E as ye,F as fe,G as we,H as _,I as z,J as ke,K as b,L as He}from"./app-B8gNu4K5.js";const qe=["/","/guide/configcenter/apollo.html","/guide/configcenter/consul-cloud.html","/guide/configcenter/custom.html","/guide/configcenter/etcd.html","/guide/configcenter/huawei-cloud.html","/guide/configcenter/nacos-cloud.html","/guide/configcenter/nacos.html","/guide/configcenter/none.html","/guide/configcenter/polaris.html","/guide/configcenter/zookeeper-cloud.html","/guide/configcenter/zookeeper.html","/guide/middleware/brpc.html","/guide/middleware/dubbo.html","/guide/middleware/grpc.html","/guide/middleware/hystrix.html","/guide/middleware/jetty.html","/guide/middleware/liteflow.html","/guide/middleware/motan.html","/guide/middleware/okhttp3.html","/guide/middleware/rabbitmq.html","/guide/middleware/rocketmq.html","/guide/middleware/sofa.html","/guide/middleware/tars.html","/guide/middleware/tomcat.html","/guide/middleware/undertow.html","/guide/introduction/architecture.html","/guide/introduction/background.html","/guide/introduction/benchmark.html","/guide/introduction/functions.html","/guide/monitor/collect_types.html","/guide/monitor/custom.html","/guide/monitor/hertzbeat.html","/guide/monitor/prometheus_grafana.html","/guide/other/articles.html","/guide/other/contact.html","/guide/other/develop.html","/guide/other/faq.html","/guide/other/members.html","/guide/other/release.html","/guide/other/supportme.html","/guide/other/users.html","/guide/notice/alarm.html","/guide/notice/custom.html","/guide/notice/email.html","/guide/notice/notice.html","/guide/notice/populate_message.html","/guide/notice/ratelimiter.html","/guide/notice/yunzhijia.html","/guide/use/agent.html","/guide/use/code.html","/guide/use/env.html","/guide/use/global.html","/guide/use/mode.html","/guide/use/quick-start.html","/guide/use/reject.html","/guide/use/wrapper.html","/404.html","/guide/configcenter/","/guide/","/guide/middleware/","/guide/introduction/","/guide/monitor/","/guide/other/","/guide/notice/","/guide/use/"],Re="SLIMSEARCH_QUERY_HISTORY",p=U(Re,[]),be=()=>{const{queryHistoryCount:i}=b,s=i>0;return{enabled:s,queryHistories:p,addQueryHistory:u=>{s&&(p.value=Array.from(new Set([u,...p.value.slice(0,i-1)])))},removeQueryHistory:u=>{p.value=[...p.value.slice(0,u),...p.value.slice(u+1)]}}},E=i=>qe[i.id]+("anchor"in i?`#${i.anchor}`:""),xe="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:M}=b,y=U(xe,[]),Qe=()=>{const i=M>0;return{enabled:i,resultHistories:y,addResultHistory:s=>{if(i){const u={link:E(s),display:s.display};"header"in s&&(u.header=s.header),y.value=[u,...y.value.slice(0,M-1)]}},removeResultHistory:s=>{y.value=[...y.value.slice(0,s),...y.value.slice(s+1)]}}},Ce=i=>{const s=me(),u=O(),x=he(),r=A(0),w=R(()=>r.value>0),g=ge([]);return ve(()=>{const{search:v,terminate:Q}=pe(),f=ke(o=>{const{resultsFilter:k=n=>n,querySplitter:j,suggestionsFilter:C,...S}=s.value;o?(r.value+=1,v(o,u.value,S).then(n=>k(n,o,u.value,x.value)).then(n=>{r.value-=1,g.value=n}).catch(n=>{console.warn(n),r.value-=1,r.value||(g.value=[])})):g.value=[]},b.searchDelay-b.suggestDelay,{maxWait:5e3});P([i,u],([o])=>{f(o.join(" "))},{immediate:!0}),ye(()=>{Q()})}),{isSearching:w,results:g}};var Le=te({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(i,{emit:s}){const u=le(),x=O(),r=ie(se),{enabled:w,addQueryHistory:g,queryHistories:v,removeQueryHistory:Q}=be(),{enabled:f,resultHistories:o,addResultHistory:k,removeResultHistory:j}=Qe(),C=w||f,S=ue(i,"queries"),{results:n,isSearching:Y}=Ce(S),a=ae({isQuery:!0,index:0}),m=A(0),h=A(0),F=R(()=>C&&(v.value.length>0||o.value.length>0)),L=R(()=>n.value.length>0),$=R(()=>n.value[m.value]||null),B=()=>{const{isQuery:e,index:t}=a;t===0?(a.isQuery=!e,a.index=e?o.value.length-1:v.value.length-1):a.index=t-1},G=()=>{const{isQuery:e,index:t}=a;t===(e?v.value.length-1:o.value.length-1)?(a.isQuery=!e,a.index=0):a.index=t+1},J=()=>{m.value=m.value>0?m.value-1:n.value.length-1,h.value=$.value.contents.length-1},K=()=>{m.value=m.value<n.value.length-1?m.value+1:0,h.value=0},V=()=>{h.value<$.value.contents.length-1?h.value+=1:K()},W=()=>{h.value>0?h.value-=1:J()},D=e=>e.map(t=>He(t)?t:l(t[0],t[1])),N=e=>{if(e.type==="customField"){const t=fe[e.index]||"$content",[c,q=""]=we(t)?t[x.value].split("$content"):t.split("$content");return e.display.map(d=>l("div",D([c,...d,q])))}return e.display.map(t=>l("div",D(t)))},H=()=>{m.value=0,h.value=0,s("updateQuery",""),s("close")},X=()=>w?l("ul",{class:"slimsearch-result-list"},l("li",{class:"slimsearch-result-list-item"},[l("div",{class:"slimsearch-result-title"},r.value.queryHistory),v.value.map((e,t)=>l("div",{class:["slimsearch-result-item",{active:a.isQuery&&a.index===t}],onClick:()=>{s("updateQuery",e)}},[l(_,{class:"slimsearch-result-type"}),l("div",{class:"slimsearch-result-content"},e),l("button",{class:"slimsearch-remove-icon",innerHTML:z,onClick:c=>{c.preventDefault(),c.stopPropagation(),Q(t)}})]))])):null,Z=()=>f?l("ul",{class:"slimsearch-result-list"},l("li",{class:"slimsearch-result-list-item"},[l("div",{class:"slimsearch-result-title"},r.value.resultHistory),o.value.map((e,t)=>l(I,{to:e.link,class:["slimsearch-result-item",{active:!a.isQuery&&a.index===t}],onClick:()=>{H()}},()=>[l(_,{class:"slimsearch-result-type"}),l("div",{class:"slimsearch-result-content"},[e.header?l("div",{class:"content-header"},e.header):null,l("div",e.display.map(c=>D(c)).flat())]),l("button",{class:"slimsearch-remove-icon",innerHTML:z,onClick:c=>{c.preventDefault(),c.stopPropagation(),j(t)}})]))])):null;return re("keydown",e=>{if(i.isFocusing){if(L.value){if(e.key==="ArrowUp")W();else if(e.key==="ArrowDown")V();else if(e.key==="Enter"){const t=$.value.contents[h.value];g(i.queries.join(" ")),k(t),u.push(E(t)),H()}}else if(f){if(e.key==="ArrowUp")B();else if(e.key==="ArrowDown")G();else if(e.key==="Enter"){const{index:t}=a;a.isQuery?(s("updateQuery",v.value[t]),e.preventDefault()):(u.push(o.value[t].link),H())}}}}),P([m,h],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>l("div",{class:["slimsearch-result-wrapper",{empty:i.queries.length?!L.value:!F.value}],id:"slimsearch-results"},i.queries.length?Y.value?l(ne,{hint:r.value.searching}):L.value?l("ul",{class:"slimsearch-result-list"},n.value.map(({title:e,contents:t},c)=>{const q=m.value===c;return l("li",{class:["slimsearch-result-list-item",{active:q}]},[l("div",{class:"slimsearch-result-title"},e||r.value.defaultTitle),t.map((d,ee)=>{const T=q&&h.value===ee;return l(I,{to:E(d),class:["slimsearch-result-item",{active:T,"aria-selected":T}],onClick:()=>{g(i.queries.join(" ")),k(d),H()}},()=>[d.type==="text"?null:l(d.type==="title"?oe:d.type==="heading"?ce:de,{class:"slimsearch-result-type"}),l("div",{class:"slimsearch-result-content"},[d.type==="text"&&d.header?l("div",{class:"content-header"},d.header):null,l("div",N(d))])])})])})):r.value.emptyResult:C?F.value?[X(),Z()]:r.value.emptyHistory:r.value.emptyResult)}});export{Le as default};
